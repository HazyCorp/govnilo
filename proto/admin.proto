syntax = "proto3";

option go_package = "github.com/HazyCorp/govnilo/proto";

import "google/protobuf/duration.proto";

package admin.proto;

service AdminService {
    rpc SetSettings(SetSettingsReq) returns (SetSettingsRsp);
    rpc GetSettings(GetSettingsReq) returns (GetSettingsRsp);
}

message SetSettingsReq {
    Settings settings = 1;
}

message SetSettingsRsp {
    // empty
}

message GetSettingsReq {
    // emtpy
}

message GetSettingsRsp {
    Settings settings = 1;
}

message Settings {
    repeated ServiceSettings services = 1;
}

message ServiceSettings {
    string name = 1;
    string target = 2;
    repeated CheckerSettings checkers = 3;
}

message Rate {
    uint64 times = 1;
    google.protobuf.Duration per = 2;
}

message CheckerSettings {
    string name = 1;
    RunOptions run_options = 2;
    double success_points = 3;
    double fail_penalty = 4;
}

message RunOptions {
    Rate rate = 1;
    int32 max_goroutines = 2;
}
